---
title: 'CAN Bus'
description: 'Controller Area Network (CAN)'
---

<Tip>
Bölüm bitiminde Gemstone geliştirme kartında sanal CAN arayüzü oluşturma hakkında bilgi sahibi olacaksınız.
</Tip>

Gemstone işletim sisteminde sanal CAN arayüzü oluşturularak herhangi ilave donanıma gerek kalmadan bu arayüz üzerinden 
veri iletişimi sağlanabilmektedir.

<Frame caption="Todo: CanBUS pinlerinin gösterildiği kart fotoğrafı">
  <img className="rounded-lg" noZoom src="/images/under-construction.png" />
</Frame>

* Gemstone işletim sistemine bağlandıktan sonra sanal CAN arayüzü oluşturabilmek için `kernel-module-vcan-6.1.83-ti` 
modülünü kurunuz.

```bash
sudo apt install picocom kernel-module-vcan-6.1.83-ti
```

* `modprobe` komutu ile kurulan modülü aktif ediniz.

```bash
sudo modprobe vcan
```

* Aşağıdaki komutları takip ederek sanal CAN arayüzünü oluşturunuz.

```bash
sudo ip link add dev vcan0 type vcan
sudo ip link set up vcan0
```

* `can-test.sh` isimli bir script dosyası oluşturunuz ve dosyayı açınız.

```bash
touch can-test.sh
nano can-test.sh
```

* Aşağıdaki kodu kopyalayıp `can-test.sh` dosyasına yapıştırınız. Dosyayı kaydedip kapatınız.

```bash
#!/bin/bash

while :
do
   cansend vcan0 123 #AABBCCDDEE112233
   sleep 1
done
```

* `cansend` ve `candump` gibi CAN paketleri gönderim alım komutlarını kullanabilmek için `can-utils` paketini kurunuz.

```bash
sudo apt install can-utils
```

1. İki adet terminal açınız. 

2. İlk terminalden CAN arayüzünü dinleme işlemini başlatınız.

```bash
candump vcan0
```

3. İkinci terminalden can-test.sh scriptini çalıştırınız.

```bash
./can-test.sh
```

<Frame caption="Sanal CAN arayüzü üzerinden haberleşme">
  <video controls className="w-full aspect-video" src="/videos/can-test.mp4"></video>
</Frame>
